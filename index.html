<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Super Pop Guinea Pig</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Kanit:wght@400;600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #ff9a9e;
            --bg-gradient: linear-gradient(120deg, #a1c4fd 0%, #c2e9fb 100%);
            --text-shadow: 3px 3px 0px #00000020;
        }

        body {
            background-image: var(--bg-gradient);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            font-family: 'Fredoka One', 'Kanit', sans-serif;
            overflow: hidden;
            user-select: none;
            touch-action: manipulation; /* ‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            -webkit-tap-highlight-color: transparent;
        }

        /* ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô */
        .score-container {
            text-align: center;
            margin-bottom: 20px;
            z-index: 10;
        }

        h1 {
            font-size: 80px;
            margin: 0;
            color: #fff;
            text-shadow: 4px 4px 0px #333;
            line-height: 1;
        }

        .rank-badge {
            font-family: 'Kanit', sans-serif;
            font-size: 24px;
            color: #555;
            background: rgba(255, 255, 255, 0.8);
            padding: 5px 20px;
            border-radius: 20px;
            margin-top: 10px;
            display: inline-block;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* ‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏π‡∏ï‡∏∞‡πÄ‡∏†‡∏≤ */
        .guinea-container {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #guinea-pig {
            width: 350px;
            max-width: 90vw;
            cursor: pointer;
            transition: transform 0.05s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            -webkit-user-drag: none;
            filter: drop-shadow(0 10px 15px rgba(0,0,0,0.2));
        }

        #guinea-pig.popped {
            transform: scale(0.95);
        }

        /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏•‡∏≠‡∏¢ (+1) */
        .pop-number {
            position: absolute;
            color: #fff;
            font-size: 40px;
            font-weight: bold;
            pointer-events: none;
            text-shadow: 2px 2px 0 #000;
            animation: floatUp 0.8s ease-out forwards;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-100px) scale(1.5); opacity: 0; }
        }

        /* ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° (‡πÄ‡∏™‡∏µ‡∏¢‡∏á/‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï) */
        .controls {
            position: absolute;
            bottom: 30px;
            display: flex;
            gap: 15px;
        }

        .btn {
            background: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            font-family: 'Kanit', sans-serif;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 0 #ddd;
            transition: transform 0.1s, box-shadow 0.1s;
            color: #555;
        }

        .btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #ddd;
        }

        .btn-reset { color: #ff6b6b; }
        
        /* Footer Credit */
        .credit {
            position: absolute;
            bottom: 10px;
            font-size: 12px;
            color: #666;
            opacity: 0.6;
        }

    </style>
</head>
<body>

    <div class="score-container">
        <h1 id="score">0</h1>
        <div id="rank" class="rank-badge">‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏π‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î üêπ</div>
    </div>

    <div class="guinea-container" id="click-area">
        <img id="guinea-pig" src="picture/Guinea1.jpg" alt="Guinea Pig">
    </div>

    <div class="controls">
        <button class="btn" id="sound-btn">üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á</button>
        <button class="btn btn-reset" onclick="resetScore()">‚Ü∫ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
    </div>
    
    <div class="credit">Tap as fast as you can!</div>

    <audio id="pop-sound" src="sounds/clicks.mp3"></audio> 
    <script>
        // --- ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ ---
        const guineaImg = document.getElementById('guinea-pig');
        const scoreElement = document.getElementById('score');
        const rankElement = document.getElementById('rank');
        const clickArea = document.getElementById('click-area');
        const popSoundSrc = document.getElementById('pop-sound').src;
        const soundBtn = document.getElementById('sound-btn');
        
        // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Cache (Preload) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏£‡∏∞‡∏û‡∏£‡∏¥‡∏ö
        const imgOpen = new Image(); imgOpen.src = "picture/Guinea2.jpg";
        const imgClose = new Image(); imgClose.src = "picture/Guinea1.jpg";

        let score = parseInt(localStorage.getItem('popGuineaScore')) || 0;
        let isSoundOn = true;
        let audioPool = []; // Pool ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ

        // --- ‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏® (Ranks) ---
        const ranks = [
            { score: 0, title: "‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏π‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î üêπ" },
            { score: 100, title: "‡∏´‡∏ô‡∏π‡∏ô‡∏±‡∏Å‡∏Å‡∏¥‡∏ô ü•ï" },
            { score: 500, title: "‡∏´‡∏ô‡∏π‡∏ï‡∏¥‡∏î‡∏™‡∏õ‡∏µ‡∏î ‚ö°" },
            { score: 1000, title: "‡∏£‡∏≤‡∏ä‡∏≤‡∏´‡∏ô‡∏π‡∏ï‡∏∞‡πÄ‡∏†‡∏≤ üëë" },
            { score: 5000, title: "‡πÄ‡∏ó‡∏û‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏π üåü" },
            { score: 10000, title: "‡∏ï‡∏≥‡∏ô‡∏≤‡∏ô‡πÅ‡∏´‡πà‡∏á‡∏à‡∏±‡∏Å‡∏£‡∏ß‡∏≤‡∏• üåå" }
        ];

        // --- ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ---
        updateDisplay();
        
        // ‡∏™‡∏£‡πâ‡∏≤‡∏á Audio Pool (‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ß‡πâ 10 ‡∏ï‡∏±‡∏ß)
        for(let i=0; i<10; i++) {
            audioPool.push(new Audio(popSoundSrc));
        }

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å ---

        function updateDisplay() {
            scoreElement.innerText = score.toLocaleString(); // ‡πÉ‡∏™‡πà‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≥‡∏Ñ‡∏±‡πà‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏¢‡∏®
            let currentRank = ranks[0].title;
            for (let r of ranks) {
                if (score >= r.score) currentRank = r.title;
            }
            rankElement.innerText = currentRank;
        }

        function playSound() {
            if (!isSoundOn) return;
            // ‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏°‡∏≤‡πÄ‡∏•‡πà‡∏ô (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏£‡∏±‡∏ß‡πÜ)
            const sound = audioPool.find(a => a.paused) || audioPool[0];
            sound.currentTime = 0;
            sound.play().catch(() => {}); // catch error ‡∏Å‡∏£‡∏ì‡∏µ browser ‡∏ö‡∏•‡πá‡∏≠‡∏Å
        }

        function spawnParticle(x, y) {
            const el = document.createElement('div');
            el.innerText = "+1";
            el.className = 'pop-number';
            
            // ‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πä‡∏∞
            const randomX = (Math.random() - 0.5) * 40;
            const randomY = (Math.random() - 0.5) * 40;
            
            el.style.left = (x + randomX) + 'px';
            el.style.top = (y + randomY) + 'px';
            
            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ó‡∏ò‡πå‡∏Å‡∏±‡∏ö clickArea
            const rect = clickArea.getBoundingClientRect();
            el.style.left = (x - rect.left) + 'px';
            el.style.top = (y - rect.top) + 'px';

            clickArea.appendChild(el);

            // ‡∏•‡∏ö Element ‡∏ó‡∏¥‡πâ‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô Animation ‡∏à‡∏ö
            setTimeout(() => el.remove(), 800);
        }

        function pop(e) {
            // Logic ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
            score++;
            localStorage.setItem('popGuineaScore', score);
            updateDisplay();

            // Visual ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ
            guineaImg.src = imgOpen.src;
            guineaImg.classList.add('popped');

            // Audio
            playSound();

            // Effect (+1)
            // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏à‡∏≤‡∏Å Mouse/Touch ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ô‡∏±‡πâ‡∏ô ‡∏ñ‡πâ‡∏≤‡∏Å‡∏î Keyboard ‡πÉ‡∏´‡πâ‡∏™‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏≤‡∏á‡∏†‡∏≤‡∏û
            let clientX, clientY;
            if (e && (e.type === 'mousedown' || e.type === 'touchstart' || e.type === 'pointerdown')) {
                // ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á Mouse ‡πÅ‡∏•‡∏∞ Touch
                clientX = e.clientX || (e.touches && e.touches[0].clientX);
                clientY = e.clientY || (e.touches && e.touches[0].clientY);
            } else {
                // ‡∏Å‡∏£‡∏ì‡∏µ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î
                const rect = guineaImg.getBoundingClientRect();
                clientX = rect.left + rect.width / 2;
                clientY = rect.top + rect.height / 3;
            }
            spawnParticle(clientX, clientY);
        }

        function unpop() {
            guineaImg.src = imgClose.src;
            guineaImg.classList.remove('popped');
        }

        function resetScore() {
            if(confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏õ‡πá‡∏ô 0 ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?")) {
                score = 0;
                localStorage.setItem('popGuineaScore', 0);
                updateDisplay();
            }
        }

        // --- Event Listeners (‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°) ---

        // ‡πÉ‡∏ä‡πâ Pointer Events ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á Mouse, Touch, Pen ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
        guineaImg.addEventListener('pointerdown', (e) => {
            e.preventDefault(); // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ
            pop(e);
        });

        guineaImg.addEventListener('pointerup', (e) => {
            e.preventDefault();
            unpop();
        });

        guineaImg.addEventListener('pointerleave', unpop);

        // ‡∏£‡∏∞‡∏ö‡∏ö Keyboard (‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏´‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ)
        document.addEventListener('keydown', (e) => {
            if (e.repeat) return; // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏Ñ‡πâ‡∏≤‡∏á
            pop();
        });

        document.addEventListener('keyup', unpop);

        // ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á
        soundBtn.addEventListener('click', () => {
            isSoundOn = !isSoundOn;
            soundBtn.innerText = isSoundOn ? "üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á" : "üîá ‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á";
        });

    </script>
</body>
</html>
